{"ast":null,"code":"// actions/cartActions.js\n\nimport { CART_ADD_ITEM, CART_REMOVE_ITEM } from '../contents/cartConstents';\nimport axios from 'axios';\nexport const addToCart = (id, qty) => async (dispatch, getState) => {\n  const {\n    data\n  } = await axios.get(`/api/products/${id}`);\n  const existingCartItem = getState().cart.cartItems.find(item => item.product === id);\n  const currentQty = existingCartItem ? existingCartItem.qty : 0;\n  const newQty = currentQty + qty; // 确保这里的逻辑正确\n\n  dispatch({\n    type: CART_ADD_ITEM,\n    payload: {\n      product: data._id,\n      name: data.name,\n      image: data.image,\n      price: data.price,\n      countInStock: data.countInStock,\n      qty: newQty\n    }\n  });\n  localStorage.setItem('cartItems', JSON.stringify(getState().cart.cartItems));\n};","map":{"version":3,"names":["CART_ADD_ITEM","CART_REMOVE_ITEM","axios","addToCart","id","qty","dispatch","getState","data","get","existingCartItem","cart","cartItems","find","item","product","currentQty","newQty","type","payload","_id","name","image","price","countInStock","localStorage","setItem","JSON","stringify"],"sources":["/Users/risun/Desktop/podian/frontend/src/actions/cartAction.js"],"sourcesContent":["// actions/cartActions.js\n\nimport { CART_ADD_ITEM, CART_REMOVE_ITEM } from '../contents/cartConstents'\nimport axios from 'axios'\n\nexport const addToCart = (id, qty) => async (dispatch, getState) => {\n    const { data } = await axios.get(`/api/products/${id}`);\n  \n    const existingCartItem = getState().cart.cartItems.find((item) => item.product === id);\n    const currentQty = existingCartItem ? existingCartItem.qty : 0;\n  \n    const newQty = currentQty + qty; // 确保这里的逻辑正确\n  \n    dispatch({\n      type: CART_ADD_ITEM,\n      payload: {\n        product: data._id,\n        name: data.name,\n        image: data.image,\n        price: data.price,\n        countInStock: data.countInStock,\n        qty: newQty,\n      },\n    });\n  \n    localStorage.setItem('cartItems', JSON.stringify(getState().cart.cartItems));\n  };\n  "],"mappings":"AAAA;;AAEA,SAASA,aAAa,EAAEC,gBAAgB,QAAQ,2BAA2B;AAC3E,OAAOC,KAAK,MAAM,OAAO;AAEzB,OAAO,MAAMC,SAAS,GAAGA,CAACC,EAAE,EAAEC,GAAG,KAAK,OAAOC,QAAQ,EAAEC,QAAQ,KAAK;EAChE,MAAM;IAAEC;EAAK,CAAC,GAAG,MAAMN,KAAK,CAACO,GAAG,CAAE,iBAAgBL,EAAG,EAAC,CAAC;EAEvD,MAAMM,gBAAgB,GAAGH,QAAQ,CAAC,CAAC,CAACI,IAAI,CAACC,SAAS,CAACC,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACC,OAAO,KAAKX,EAAE,CAAC;EACtF,MAAMY,UAAU,GAAGN,gBAAgB,GAAGA,gBAAgB,CAACL,GAAG,GAAG,CAAC;EAE9D,MAAMY,MAAM,GAAGD,UAAU,GAAGX,GAAG,CAAC,CAAC;;EAEjCC,QAAQ,CAAC;IACPY,IAAI,EAAElB,aAAa;IACnBmB,OAAO,EAAE;MACPJ,OAAO,EAAEP,IAAI,CAACY,GAAG;MACjBC,IAAI,EAAEb,IAAI,CAACa,IAAI;MACfC,KAAK,EAAEd,IAAI,CAACc,KAAK;MACjBC,KAAK,EAAEf,IAAI,CAACe,KAAK;MACjBC,YAAY,EAAEhB,IAAI,CAACgB,YAAY;MAC/BnB,GAAG,EAAEY;IACP;EACF,CAAC,CAAC;EAEFQ,YAAY,CAACC,OAAO,CAAC,WAAW,EAAEC,IAAI,CAACC,SAAS,CAACrB,QAAQ,CAAC,CAAC,CAACI,IAAI,CAACC,SAAS,CAAC,CAAC;AAC9E,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}